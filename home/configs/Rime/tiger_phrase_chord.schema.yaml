# Rime schema
# encoding: utf-8
# CC-BY-4.0

schema:
  author:
    - Hertz Hwang <hertz@26hz.com.cn>
  dependencies:
    - charset
    - pinyin
    - fast_symbol
    - tiger_spelling_pseudo
    - radical_flypy
    - easy_en
    - japanese
    - tiger_codes
    - tiger_oni
    - tiger_phrases
  description: |
    ğŸ¯Â·å•å¥Â·å¹¶å‡»
  name: "ğŸ¯Â·å•å¥Â·å¹¶å‡»"
  schema_id: tiger_phrase_chord
  version: "2024-12-22"

switches:
  - name: ascii_mode
    reset: 0
    states: [ è™, è‹± ]
  - name: extended_char
    states: [ å…¨å­—é›†, å¸¸ç”¨å­— ]
    reset: 1
  - name: traditionalization
    states: [ ç®€, ç¹ ]
    reset: 0
  - name: full_shape
    reset: 0
    states: [ åŠè§’, å…¨è§’ ]
  - name: ascii_punct
    reset: 0
    states: [ ã€‚ï¼Œ, ï¼ï¼Œ ]

engine:
  processors:
    - ascii_composer                              # å¤„ç†è‹±æ–‡æ¨¡å¼åŠä¸­è‹±æ–‡åˆ‡æ¢
    - chord_composer                              # å¤„ç†å¹¶å‡»
    - recognizer                                  # ä¸ matcher æ­é…ï¼Œå¤„ç†ç¬¦åˆç‰¹å®šè§„åˆ™çš„è¾“å…¥ç ï¼Œå¦‚ç½‘å€ã€åæŸ¥ç­‰
    - key_binder                                  # åœ¨ç‰¹å®šæ¡ä»¶ä¸‹å°†æŒ‰é”®ç»‘å®šåˆ°å…¶ä»–æŒ‰é”®ï¼Œå¦‚é‡å®šä¹‰é€—å·ã€å¥å·ä¸ºå€™é€‰ç¿»é¡µé”®
    - lua_processor@*hertz.jane_processor
    - speller                                     # æŠŠå­—æ¯è¿½åŠ åˆ°ç¼–ç ä¸²
    - punctuator                                  # å¤„ç†ç¬¦å·æŒ‰é”®
    - selector                                    # é€‰å­—å’Œæ¢é¡µåŠŸèƒ½
    - navigator                                   # ç§»åŠ¨æ’å…¥ç‚¹
    - express_editor                              # ç©ºæ ¼ç¡®è®¤å½“å‰è¾“å…¥ï¼Œå…¶ä»–å­—ç¬¦ç›´æ¥ä¸Šå±
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor                               # æ ‡è®°è¾“å…¥ç çš„ç±»å‹
    - punct_segmentor                             # å‰²ç•Œï¼Œä¸å‰åæ–¹çš„å…¶ä»–ç¼–ç åŒºåˆ†å¼€
    - fallback_segmentor
  translators:
    - punct_translator                            # è½¬æ¢æ ‡ç‚¹ç¬¦å·
    - script_translator                           # ç è¡¨è½¬æ¢
  filters:
    - lua_filter@*hertz.charset_filter            # å­—é›†è¿‡æ»¤
    - simplifier@s2t                              # ç®€ç¹æ»¤é•œ
    - uniquifier                                  # è¿‡æ»¤é‡å¤çš„å€™é€‰å­—ï¼Œå¯èƒ½æ¥è‡ªç®€ç¹è½¬æ¢

__include: tiger:/s2t_filter                      # ç®€ç¹æ»¤é•œ

speller:
  alphabet: QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm;':"<>?,./~!@#$%^&*()_+-=[]\{}|1234567890
  delimiter: "_`"
  algebra:
    - addrev/([A-Z])/\L$1/

translator:
  dictionary: tiger_phrase_chord
  enable_user_dict: false
  enable_charset_filter: false
  enable_encoder: false
  enable_sentence: false
  encode_commit_history: false
  enable_completion: false
  preedit_format:
    # æ‰‹åŠ¨åˆ†è¯æ ‡è®°
    - xform/([a-z]{4})[']/$1â´/
    - xform/([a-z]{3})[']/$1Â³/
    - xform/([a-z]{2})[']/$1Â²/
    - xform/([a-z]{1})[']/$1Â¹/
    # è‡ªåŠ¨åˆ†è¯æ ‡è®°
    - xform/([a-z]{1,4})[_]/$1â£/
    # å…¶ä½™å¤„ç†
    #- xform/([A-Z])/\L$1/
    - xform/([A-Z])/$1Â°/  # å¹¶å‡»æç¤ºç¬¦ï¼Œå¯é€‰ Â° âˆ áµ† Ê¬ Ëœ 
    - xform/([Â¹Â²Â³â´][a-z]+)[_']/$1/
    - xform/([Â¹Â²Â³â´])_/$1/
    - xform/_/â£/
    #- xlit/ABCDEFGHIJKLMNOPQRSTUVWXYZ/áº¡á¸…Ä‹á¸áº¹á¸ŸÄ¡á¸¥á»‹Äµá¸³á¸·á¹ƒá¹‡á»á¹—ê—á¹›á¹£á¹­á»¥á¹¿áº‰áº‹á»µáº“/
    #- xlit/ABCDEFGHIJKLMNOPQRSTUVWXYZ/â“â“‘â“’â““â“”â“•â“–â“—â“˜â“™â“šâ“›â“œâ“â“â“Ÿâ“ â“¡â“¢â“£â“¤â“¥â“¦â“§â“¨â“©/

key_binder:
  import_preset: default
  custom_bindings:
    __append:
      # åœ¨é€™è£æ·»åŠ åªåœ¨æœ¬æ–¹æ¡ˆä¸­ç”Ÿæ•ˆçš„æŒ‰éµç¶å®š
  bindings:
    __patch:
      - :/key_binder/custom_bindings?
      - tiger:/keys/emacs_mode
      - tiger:/keys/tab
      - tiger:/keys/page_up_down
      #- tiger:/keys/selector
      - tiger:/keys/options_toggle

#__include: tiger:/rec
recognizer:
  import_preset: default
  patterns:
    punct: '^/([0-9]0?|[A-Za-z]+)$'
    #radical_flypy: "^R[a-z]*`?$"
    reverse_lookup: "^`[a-z]*'?$"
    expression: '^=.*$'

punctuator:
  #import_preset:
  __include: tiger:/punctuator

tiger_spelling:
  lua:
    switch_key: "Control+c"
    cycle_key: "Shift+Control+C"
schema_name:
  spelling: tiger_spelling_pseudo
  code: tiger_phrase_chord

menu:
  page_size: 1

chord_composer:
  alphabet: qazwsxedcrfvtgbyhnujmik,ol.p;/ `
  algebra:  # æ¥è‡ªçŒ«å¸ˆè‡ªç„¶ç å¹¶å‡»æŒ‡æ³•
    - xlit|;,./|ACXZ|  # ç¬¦å·æ˜ å°„ä¸ºå¤§å†™å­—æ¯ï¼Œåˆ†ç¦»å…¶è½¬ä¹‰å¹²æ‰°
    - xlit| |ä¸€|  # ä¸»ç©ºæ ¼
    - xform/^([qwertasdfgzxcvb]+)([ä¸€]*)$/$1_$2/  # å¤„ç†å·¦æ‰‹å‡»çš„è¡¨ç¤º
    - xform/^([yuiophjklAnmCXZ]+)([ä¸€]*)$/_$1$2/  # å¤„ç†å³æ‰‹å‡»çš„è¡¨ç¤º
    - xform/^([qwertasdfgzxcvb]+)([yuiophjklAnmCXZ]+)([ä¸€]*)$/$1$2$3/  # åˆå¹¶å•æ‰‹å‡»çš„è¡¨ç¤º

    - xform/([qwertasdfgzxcvb]+)/<$1>/  # å·¦æ‰‹ç¼–ç åŒ…è£…
    - xform/([yuiophjklAnmCXZ]+)/<$1>/  # å³æ‰‹ç¼–ç åŒ…è£…
    - xform/([ä¸€]+)/<$1>/  # ç©ºæ ¼åŒºç¼–ç åŒ…è£…

    # å­—æ¯
    - xform=(<zv>|<mZ>)=Q=
    - xform=(<wv>|<no>)=W=
    - xform=(<ev>|<ni>)=E=
    - xform=(<et>|<yi>)=R=
    - xform=(<qt>|<yp>)=T=
    - xform=(<wt>|<yo>)=Y=
    - xform=(<af>|<jA>)=U=
    - xform=(<xv>|<mX>)=I=
    - xform=(<aw>|<oA>)=O=
    - xform=(<qf>|<jp>)=P=
    - xform=(<wer>|<uio>)=/=
    - xform=(<qwe>|<iop>)=\=
    - xform=(<rt>|<yu>)=[=
    - xform=(<ert>|<yui>)=]=

    - xform=(<av>|<nA>)=A=
    - xform=(<sv>|<nl>)=S=
    - xform=(<dv>|<nk>)=D=
    - xform=(<sg>|<hl>)=F=
    - xform=(<dg>|<hk>)=G=
    - xform=(<ar>|<uA>)=H=
    - xform=(<xf>|<jX>)=J=
    - xform=(<xc>|<CX>)=K=
    - xform=(<sr>|<ul>)=L=
    - xform=(<dc>|<mk>)=~=
    - xform=(<fv>|<nj>)=|=
    - xform=(<fg>|<hj>)=(=
    - xform=(<dfg>|<hjk>)=)=

    - xform=(<zf>|<jZ>)=Z=
    - xform=(<xd>|<kX>)=X=
    - xform=(<xb>|<nX>)=C=
    - xform=(<zs>|<lZ>)=V=
    - xform=(<qw>|<op>)=B=
    - xform=(<se>|<il>)=N=
    - xform=(<wd>|<ko>)=M=
    - xform=(<at>|<yA>)=<=
    - xform=(<ag>|<hA>)=>=
    - xform=(<zx>|<XZ>)=@=
    - xform=(<vb>|<nm>)=$=

    - xform=(<q>|<p>)=q=
    - xform=(<w>|<o>)=w=
    - xform=(<e>|<i>)=e=
    - xform=(<r>|<u>)=r=
    - xform=(<t>|<y>)=t=
    - xform=(<ef>|<ji>)=y=
    - xform=(<er>|<ui>)=u=
    - xform=(<we>|<io>)=i=
    - xform=(<wr>|<uo>)=o=
    - xform=(<qr>|<up>)=p=
    - xform=(<qe>|<ip>)=%=
    - xform=(<wg>|<ho>)=-=
    - xform/(<qg>|<hp>)/=/

    - xform=(<a>|<A>)=a=
    - xform=(<s>|<l>)=s=
    - xform=(<d>|<k>)=d=
    - xform=(<f>|<j>)=f=
    - xform=(<g>|<h>)=g=
    - xform=(<wf>|<jo>)=h=
    - xform=(<df>|<jk>)=j=
    - xform=(<sd>|<kl>)=k=
    - xform=(<sf>|<jl>)=l=
    - xform=(<as>|<lA>)=:=
    - xform=(<ad>|<kA>)=;=
    - xform=(<asd>|<klA>)='=
    - xform=(<adf>|<jkA>)="=
    - xform=(<rf>|<uj>)=_=
    - xform=(<rg>|<hu>)={=
    - xform=(<eg>|<hi>)=}=

    - xform=(<z>|<Z>)=z=
    - xform=(<x>|<X>)=x=
    - xform=(<c>|<C>)=c=
    - xform=(<v>|<m>)=v=
    - xform=(<b>|<n>)=b=
    - xform=(<sc>|<Cl>)=n=
    - xform=(<cv>|<mC>)=m=
    - xform=(<sdf>|<jkl>)=,=
    - xform=(<wef>|<jio>)=.=
    - xform=(<sef>|<jil>)=!=
    - xform=(<zb>|<nZ>)=?=
    - xform=(<zc>|<CZ>)=#=
    - xform=(<zxc>|<CXZ>)=*=
    - xform=(<xcv>|<mCX>)=&=
    - xform=(<cvb>|<nmC>)=+=

    - xform|(.)_<ä¸€>|<"1>$1_|
    - xform|_(.)<ä¸€>|<"1>_$1|
    - xform|(..)<ä¸€>|<"1>$1|
    - xform|^<ä¸€>|<1>|

    - xform/<1>/ /
    - xform/<"1>/"/
    - xform/"([a-zA-Z])f$/$1/  # å·¦å¤§å°å†™ + å³j + ç©ºæ ¼ï¼Œä¸ºè¡¥ç¬¬ä¸‰ç 
    - xform/"f([a-zA-Z])$/$1/  # å·¦f + å³å¤§å°å†™ + ç©ºæ ¼ï¼Œä¸ºè¡¥ç¬¬ä¸‰ç 

    - xform/^.*<.+>.*$//

    - xform=ï¼Œ="""",=
    - xform=ã€‚="""".=
    - xform=ï¼=""""!=
    - xform=ï¼Ÿ=""""?=

  prompt_format:
    # ç å…ƒæ˜¾ç¤ºæ•ˆæœä¿®æ­£
    - xform/"""",$/ï¼Œ/
    - xform/""""\.$/ã€‚/
    - xform/""""!$/ï¼/
    - xform/""""\?$/ï¼Ÿ/
